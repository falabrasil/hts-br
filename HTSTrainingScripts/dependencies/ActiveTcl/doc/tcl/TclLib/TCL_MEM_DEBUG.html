<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>ActiveTcl 8.6.7 Documentation</title>
    <meta name="generator" content="Hugo 0.30.2" />

    
    <meta name="description" content="Complete documentation for ActiveTcl 8.6.7">
    
    <link rel="canonical" href="TCL_MEM_DEBUG.html">
    

    
    <meta name="apple-mobile-web-app-title" content="ActiveTcl 8.6.7 Documentation">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="../../images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="../../images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('../../fonts/icon.eot');
        src: url('../../fonts/icon.eot')
               format('embedded-opentype'),
             url('../../fonts/icon.woff')
               format('woff'),
             url('../../fonts/icon.ttf')
               format('truetype'),
             url('../../fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="../../stylesheets/application.css">
    <link rel="stylesheet" href="../../stylesheets/temporary.css">
    <link rel="stylesheet" href="../../stylesheets/palettes.css">
    <link rel="stylesheet" href="../../stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open%20Sans:400,700|Source+Code+Pro">
    <style>
      body, input {
        font-family: 'Open Sans', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Source Code Pro', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="../../stylesheets/as_common.css">
    
    <link rel="stylesheet" href="../../stylesheets/as_custom.css">
    
    <script src="../../javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-grey palette-accent-red">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="logo">
        <a href="http://www.activestate.com/">
          <img src="../../images/logo.png" alt="ActiveState homepage">
        </a>
      </div>
      <div class="title">
        
        
        
        
        <a href="http://docs.activestate.com/">docs.activestate.com</a>
      </div>
    </div>

    

    

    
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>

</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="../../index.html" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../images/as_tcl.png">
        </div>
      
      <div class="name">
        <strong>ActiveTcl 8.6.7 Documentation </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  



<a  title="Get ActiveTcl" href="../../get/index.html">
	
	Get ActiveTcl
</a>



  
    <ul>
      
        
        



<a  title="Release notes" href="../../get/relnotes/index.html">
	
	Release notes
</a>



      
        
        



<a  title="Windows installation" href="../../get/windows/index.html">
	
	Windows installation
</a>



      
        
        



<a  title="Linux/Unix Installaton" href="../../get/linux/index.html">
	
	Linux/Unix Installaton
</a>



      
        
        



<a  title="macOS Installation" href="../../get/macos/index.html">
	
	macOS Installation
</a>



      
        
        



<a  title="License" href="../../get/license/index.html">
	
	License
</a>



      
    </ul>
  
</li>



<li>
  



<a  title="Get Started" href="../../start/index.html">
	
	Get Started
</a>



  
    <ul>
      
        
        



<a  title="Package Reference" href="../../pkg/index.html">
	
	Package Reference
</a>



      
        
        



<a  title="Tcl 8.6.7 docs" href="../contents.html">
	
	Tcl 8.6.7 docs
</a>



      
    </ul>
  
</li>



<li>
  



<a  title="Contact Us" href="../../contact/index.html">
	
	Contact Us
</a>



  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1> </h1>

			<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD><TITLE>TCL_MEM_DEBUG manual page - Tcl Library Procedures</TITLE>
<link rel="stylesheet" href="../docs.css" type="text/css" media="all">
</HEAD>
<BODY><H2><a href="../contents.html">Tcl8.6.7/Tk8.6.7 Documentation</a> <small>&gt;</small> <a href="contents.html">Tcl C API, version 8.6.7</a> <small>&gt;</small> TCL_MEM_DEBUG</H2>
<H3><A HREF="../UserCmd/contents.html">Tcl/Tk Applications</A> | <A HREF="../TclCmd/contents.html">Tcl Commands</A> | <A HREF="../TkCmd/contents.html">Tk Commands</A> | <A HREF="../ItclCmd/contents.html">[incr Tcl] Package Commands</A> | <A HREF="../SqliteCmd/contents.html">SQLite3 Package Commands</A> | <A HREF="../TdbcCmd/contents.html">TDBC Package Commands</A> | <A HREF="../TdbcmysqlCmd/contents.html">tdbc::mysql Package Commands</A> | <A HREF="../TdbcodbcCmd/contents.html">tdbc::odbc Package Commands</A> | <A HREF="../TdbcpostgresCmd/contents.html">tdbc::postgres Package Commands</A> | <A HREF="../TdbcsqliteCmd/contents.html">tdbc::sqlite3 Package Commands</A> | <A HREF="../ThreadCmd/contents.html">Thread Package Commands</A> | <A HREF="contents.html">Tcl C API</A> | <A HREF="../TkLib/contents.html">Tk C API</A> | <A HREF="../ItclLib/contents.html">[incr Tcl] Package C API</A> | <A HREF="../TdbcLib/contents.html">TDBC Package C API</A></H3>
<H3><A NAME="M2">NAME</A></H3>
TCL_MEM_DEBUG &mdash; Compile-time flag to enable Tcl memory debugging
<H3><A NAME="M3">DESCRIPTION</A></H3>
When Tcl is compiled with <B>TCL_MEM_DEBUG</B> defined, a powerful set
of memory debugging aids is included in the compiled binary.  This
includes C and Tcl functions which can aid with debugging
memory leaks, memory allocation overruns, and other memory related
errors.
<H3><A NAME="M4">ENABLING MEMORY DEBUGGING</A></H3>
To enable memory debugging, Tcl should be recompiled from scratch with
<B>TCL_MEM_DEBUG</B> defined (e.g. by passing the
<I>--enable-symbols=mem</I> flag to the <I>configure</I> script when
building).  This will also compile in a non-stub
version of <B><A HREF="DumpActiveMemory.html">Tcl_InitMemory</A></B> to add the <B><A HREF="../TclCmd/memory.html">memory</A></B> command to Tcl.
<P>
<B>TCL_MEM_DEBUG</B> must be either left defined for all modules or undefined
for all modules that are going to be linked together.  If they are not, link
errors will occur, with either <B>Tcl_DbCkfree</B> and <B>Tcl_DbCkalloc</B> or
<B><A HREF="Alloc.html">Tcl_Alloc</A></B> and <B><A HREF="Alloc.html">Tcl_Free</A></B> being undefined.
<P>
Once memory debugging support has been compiled into Tcl, the C
functions <B><A HREF="DumpActiveMemory.html">Tcl_ValidateAllMemory</A></B>, and <B><A HREF="DumpActiveMemory.html">Tcl_DumpActiveMemory</A></B>,
and the Tcl <B><A HREF="../TclCmd/memory.html">memory</A></B> command can be used to validate and examine
memory usage.
<H3><A NAME="M5">GUARD ZONES</A></H3>
When memory debugging is enabled, whenever a call to <B><A HREF="Alloc.html">ckalloc</A></B> is
made, slightly more memory than requested is allocated so the memory
debugging code can keep track of the allocated memory, and eight-byte
&#8220;guard zones&#8221;
are placed in front of and behind the space that will be
returned to the caller.  (The sizes of the guard zones are defined by the
C #define <B>LOW_GUARD_SIZE</B> and #define <B>HIGH_GUARD_SIZE</B>
in the file <I>generic/tclCkalloc.c</I> &#8212; it can
be extended if you suspect large overwrite problems, at some cost in
performance.)  A known pattern is written into the guard zones and, on
a call to <B><A HREF="Alloc.html">ckfree</A></B>, the guard zones of the space being freed are
checked to see if either zone has been modified in any way.  If one
has been, the guard bytes and their new contents are identified, and a
&#8220;low guard failed&#8221;
or
&#8220;high guard failed&#8221;
message is issued.  The
&#8220;guard failed&#8221;
message includes the address of the memory packet and
the file name and line number of the code that called <B><A HREF="Alloc.html">ckfree</A></B>.
This allows you to detect the common sorts of one-off problems, where
not enough space was allocated to contain the data written, for
example.
<H3><A NAME="M6">DEBUGGING DIFFICULT MEMORY CORRUPTION PROBLEMS</A></H3>
Normally, Tcl compiled with memory debugging enabled will make it easy
to isolate a corruption problem.  Turning on memory validation with
the memory command can help isolate difficult problems.  If you
suspect (or know) that corruption is occurring before the Tcl
interpreter comes up far enough for you to issue commands, you can set
<B>MEM_VALIDATE</B> define, recompile tclCkalloc.c and rebuild Tcl.
This will enable memory validation from the first call to
<B><A HREF="Alloc.html">ckalloc</A></B>, again, at a large performance impact.
<P>
If you are desperate and validating memory on every call to
<B><A HREF="Alloc.html">ckalloc</A></B> and <B><A HREF="Alloc.html">ckfree</A></B> is not enough, you can explicitly call
<B><A HREF="DumpActiveMemory.html">Tcl_ValidateAllMemory</A></B> directly at any point.  It takes a <I>char
*</I> and an <I>int</I> which are normally the filename and line number
of the caller, but they can actually be anything you want.  Remember
to remove the calls after you find the problem.
<H3><A NAME="M7">SEE ALSO</A></H3>
<B><A HREF="Alloc.html">ckalloc</A></B>, <B><A HREF="../TclCmd/memory.html">memory</A></B>, <B><A HREF="DumpActiveMemory.html">Tcl_ValidateAllMemory</A></B>, <B><A HREF="DumpActiveMemory.html">Tcl_DumpActiveMemory</A></B>
<H3><A NAME="M8">KEYWORDS</A></H3>
<A href="../Keywords/M.html#memory">memory</A>, <A href="../Keywords/D.html#debug">debug</A>
<div class="copy">Copyright &copy; 1992-1999 Karl Lehenbauer and Mark Diekhans.
<BR>Copyright &copy; 2000 by Scriptics Corporation.
</div>
</BODY></HTML>


			<aside class="copyright" role="note">
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				<div class="as_footer">
  
  <div class="prod_links">
    <strong>
    <a href="http://www.activestate.com/downloads" target="_blank">Downloads</a>&nbsp;&nbsp;
    <a href="http://store.activestate.com" target="_blank">Store</a>&nbsp;&nbsp;
    <a href="http://community.activestate.com" target="_blank">Community</a>&nbsp;&nbsp;
    <a href="http://code.activestate.com" target="_blank">Code</a>&nbsp;&nbsp;
    <a href="http://bugs.activestate.com" target="_blank">Bugzilla</a>
  </strong>
  </div>
  <div class="as_copyright"> 
    &copy; 2017 ActiveState Software Inc. All rights reserved. <strong><a href="../../trademarks/index.html">Trademarks</a></strong>.
  </div>
</div>

			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="../../javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "Â¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    

  </body>
</html>

